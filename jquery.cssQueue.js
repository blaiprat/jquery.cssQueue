// Generated by CoffeeScript 1.4.0

(function($) {
  return $.fn.cssQueue = function(queue) {
    this.each(function() {
      var $el, copiedQueue, processQueue;
      $el = $(this);
      copiedQueue = _.clone(queue);
      processQueue = function() {
        var actualStep, tryToCallBack, updateElement;
        actualStep = copiedQueue.shift();
        if (actualStep != null) {
          tryToCallBack = function() {
            if (actualStep.callBack != null) {
              return actualStep.callBack();
            }
          };
          updateElement = function() {
            if (actualStep.addClassName != null) {
              $el.addClass(actualStep.addClassName);
            }
            if (actualStep.removeClassName != null) {
              $el.removeClass(actualStep.removeClassName);
            }
            if (copiedQueue.length !== 0) {
              if (actualStep.transition === true) {
                $el.one("webkitTransitionEnd transitionend oTransitionEnd", function() {
                  if (copiedQueue.length !== 0) {
                    return processQueue();
                  }
                });
              } else {
                if (copiedQueue.length !== 0) {
                  setTimeout(processQueue, 0);
                }
              }
            }
            if (actualStep.callBack != null) {
              return actualStep.callBack();
            }
          };
          if (actualStep.delay > 4) {
            return setTimeout(updateElement, actualStep.delay);
          } else {
            return updateElement();
          }
        }
      };
      processQueue();
      return this;
    });
    return this;
  };
})(jQuery);
